<!doctype html><html lang=cn><head><title>WMYeah</title><meta charset=utf-8><meta content="utf-8" http-equiv=encoding><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=theme-color content="#000084"><link rel=icon href=https://www.wmyeah.com/favicon.ico><link rel=canonical href=https://www.wmyeah.com></head><body><nav class="navbar navbar-inverse navbar-fixed-top"><div class=navbar-inner><div class=container><button type=button class="btn btn-navbar" data-toggle=collapse data-target=.nav-collapse></button>
<a class=brand href=https://www.wmyeah.com>WMYeah</a><div class="nav-collapse collapse"><ul class=nav><li><a href=/about/><span>about</span></a></li><li><a href=/posts/><span>posts</span></a></li></ul></div></div></div></nav><div id=content class=container><div class="row-fluid navmargin"><div class=page-header><h1>Ubuntu 14.0.4 mysql 存储目录迁移 - Wed, Jan 6, 2016</h1></div><p class=lead></p><p>目录：</p><ul><li><a href=#1-%E8%AF%B4%E6%98%8E>1. 说明:</a></li><li><a href=#2-%E5%81%9C%E6%AD%A2mysql>2. 停止mysql</a></li><li><a href=#3-%E5%BB%BA%E7%AB%8B%E8%BF%81%E7%A7%BB%E7%9B%AE%E7%9A%84%E5%9C%B0%E6%96%87%E4%BB%B6%E5%A4%B9>3. 建立迁移目的地文件夹</a></li><li><a href=#4-%E4%BF%AE%E6%94%B9%E6%89%80%E5%B1%9E%E7%94%A8%E6%88%B7%E5%8F%8A%E6%89%80%E5%B1%9E%E7%94%A8%E6%88%B7%E7%BB%84%E4%B8%BAmysql>4. 修改所属用户及所属用户组为mysql</a></li><li><a href=#5-%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90>5. 修改权限</a></li><li><a href=#6-%E6%8B%B7%E8%B4%9Dvarlibmysql%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6>6. 拷贝"/var/lib/mysql/*&ldquo;所有文件</a></li><li><a href=#7-%E4%BF%AE%E6%94%B9mysql%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6>7. 修改mysql的配置文件</a></li><li><a href=#8-%E4%BF%AE%E6%94%B9shell%E6%96%87%E4%BB%B6>8. 修改shell文件</a></li><li><a href=#9-%E9%87%8D%E6%96%B0%E5%90%AF%E5%8A%A8apparmor%E5%92%8Cmysql>9. 重新启动apparmor和mysql</a></li><li><a href=#10-%E5%88%A0%E9%99%A4%E5%8E%9F%E6%9C%89%E6%96%87%E4%BB%B6--option>10. 删除原有文件 (-Option)</a></li><li><a href=#11-ps>11. PS:</a></li></ul><hr><hr><h1 id=1-说明>1. 说明:</h1><ul><li><p>parmars -mysqlDir- 新的mysql存储目录</p><ul><li>例如：/home/mysqlData/</li></ul></li><li><p>WARNING 注意代码中的引用到的参数</p></li></ul><hr><h1 id=2-停止mysql>2. 停止mysql</h1><pre tabindex=0><code>sudo service mysql stop
</code></pre><h1 id=3-建立迁移目的地文件夹>3. 建立迁移目的地文件夹</h1><pre tabindex=0><code>sudo mkdir -p -mysqlDir-
</code></pre><h1 id=4-修改所属用户及所属用户组为mysql>4. 修改所属用户及所属用户组为mysql</h1><pre tabindex=0><code>sudo chown -vR  mysql:mysql -mysqlDir-
</code></pre><h1 id=5-修改权限>5. 修改权限</h1><pre tabindex=0><code>sudo chmod -vR 700 -mysqlDir-
</code></pre><h1 id=6-拷贝varlibmysql所有文件>6. 拷贝&rdquo;/var/lib/mysql/*&ldquo;所有文件</h1><pre tabindex=0><code>sudo cp -av /var/lib/mysql/* -mysqlDir-
</code></pre><h1 id=7-修改mysql的配置文件>7. 修改mysql的配置文件</h1><ul><li><pre tabindex=0><code>sudo vi /etc/mysql/my.cnf
</code></pre></li><li><p>将</p><pre tabindex=0><code>datadir=/var/lib/mysql/
</code></pre></li><li><p>修改为</p><pre tabindex=0><code>datadir=-mysqlDir-
</code></pre></li></ul><h1 id=8-修改shell文件h3>8. 修改shell文件</h1><ul><li><pre tabindex=0><code>sudo vi /etc/apparmor.d/usr.sbin.mysqld
</code></pre></li><li><p>将</p><pre tabindex=0><code>/var/lib/mysql/ r,
/var/lib/mysql/** rwk,
</code></pre></li><li><p>修改为</p><pre tabindex=0><code>-mysqlDir- r,
-mysqlDir-** rwk,
</code></pre></li></ul><h1 id=9-重新启动apparmor和mysql>9. 重新启动apparmor和mysql</h1><pre tabindex=0><code>sudo service apparmor reload
sudo service mysql start
</code></pre><h1 id=10-删除原有文件--option>10. 删除原有文件 (-Option)</h1><pre tabindex=0><code>sudo rm -rvf /var/lib/mysql/
</code></pre><hr><h1 id=11-ps>11. PS:</h1><ul><li><p>根据网上资料亲测整理，最终解释权归<a href=http://www.wmyeah.com>WMYeah</a>所有!</p></li><li><p>参考资料:</p><ul><li>1、<a href=http://blog.csdn.net/wang794686714/article/details/39273385>ubuntu14.04 下 mysql 存储目录迁移</a></li><li>2、<a href=http://www.2cto.com/database/201604/496988.html>mysql数据库的使用与理解（基于ubuntu14.0.4LTS64位）</a></li><li>2、<a href=http://blog.csdn.net/lyhvoyage/article/details/50521440>ubuntu14.04下mysql数据库的默认存放路径并修改</a></li></ul></li></ul><hr><h4><a href=https://www.wmyeah.com>返回首页</a></h4></div></div><footer class=container><hr class=soften><p><a href=https://gitlab.com/maxlefou/hugo.386>hugo.386 theme by Max le Fou</a> |
&copy;
<a href=http://www.wmyeah.com target=_blank>WMYeah</a>
<span id=thisyear>2023</span>
| Example site
| 构建于 <a href=//gohugo.io target=_blank>Hugo</a></p><p class=text-center></p></footer></body><link rel=stylesheet href=/css/bootstrap.css><link rel=stylesheet href=/css/bootstrap-responsive.css><link rel=stylesheet href=/css/style.css><script src=/js/jquery.js></script>
<script src=/js/bootstrap-386.js></script>
<script src=/js/bootstrap-transition.js></script>
<script src=/js/bootstrap-alert.js></script>
<script src=/js/bootstrap-modal.js></script>
<script src=/js/bootstrap-dropdown.js></script>
<script src=/js/bootstrap-scrollspy.js></script>
<script src=/js/bootstrap-tab.js></script>
<script src=/js/bootstrap-tooltip.js></script>
<script src=/js/bootstrap-popover.js></script>
<script src=/js/bootstrap-button.js></script>
<script src=/js/bootstrap-collapse.js></script>
<script src=/js/bootstrap-carousel.js></script>
<script src=/js/bootstrap-typeahead.js></script>
<script src=/js/bootstrap-affix.js></script>
<script>_386={fastLoad:!0,onePass:!0,speedFactor:.5};function ThisYear(){document.getElementById("thisyear").innerHTML=(new Date).getFullYear()}</script></html>