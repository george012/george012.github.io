<!doctype html><html lang=cn><head><title>WMYeah</title><meta charset=utf-8><meta content="utf-8" http-equiv=encoding><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=theme-color content="#000084"><link rel=icon href=https://www.wmyeah.com/favicon.ico><link rel=canonical href=https://www.wmyeah.com></head><body><nav class="navbar navbar-inverse navbar-fixed-top"><div class=navbar-inner><div class=container><button type=button class="btn btn-navbar" data-toggle=collapse data-target=.nav-collapse></button>
<a class=brand href=https://www.wmyeah.com>WMYeah</a><div class="nav-collapse collapse"><ul class=nav><li><a href=/about/><span>about</span></a></li><li><a href=/posts/><span>posts</span></a></li></ul></div></div></div></nav><div id=content class=container><div class="row-fluid navmargin"><div class=page-header><h1>Ubuntu Server 18.0.4.4 KVM 虚拟化搭建 - Thu, Apr 2, 2020</h1></div><p class=lead></p><p>目录：</p><ul><li><a href=#1-kvm%E5%AE%89%E8%A3%85>1. KVM安装</a><ul><li><a href=#11-%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81>1.1. 检查是否支持</a></li><li><a href=#12-%E5%AE%89%E8%A3%85-cpu-checker-%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7%E5%B9%B6%E6%A3%80%E6%9F%A5%E6%9C%BA%E5%99%A8%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81-kvm>1.2. 安装 cpu-checker 检查工具并检查机器是否支持 kvm</a></li><li><a href=#13-%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85>1.3. 开始安装</a></li></ul></li><li><a href=#2-ps>2. PS:</a></li></ul><hr><h1 id=1-kvm安装>1. KVM安装</h1><h2 id=11-检查是否支持>1.1. 检查是否支持</h2><pre tabindex=0><code>egrep -c &#39;(vmx|svm)&#39; /proc/cpuinfo
</code></pre><h2 id=12-安装-cpu-checker-检查工具并检查机器是否支持-kvm>1.2. 安装 cpu-checker 检查工具并检查机器是否支持 kvm</h2><ul><li>安装cpu-checker<pre tabindex=0><code>apt install cpu-checker
</code></pre></li><li>检查<pre tabindex=0><code>kvm-ok
</code></pre></li></ul><h2 id=13-开始安装>1.3. 开始安装</h2><ul><li><p>更新apt源并且安装kvm及相关组件</p><pre tabindex=0><code>apt update &amp;&amp; apt install qemu qemu-kvm libvirt-bin  bridge-utils  virt-manager
</code></pre></li><li><p>设置网络桥接 共4网卡，2网卡给虚拟机，2网卡留给物理机</p><pre tabindex=0><code>network:
    ethernets:
        eno1:
            addresses:
            - 192.168.0.6/24
            gateway4: 192.168.0.1
            nameservers:
                addresses:
                - 192.168.0.1
        eno2:
            addresses:
            - 192.168.0.5/24
            gateway4: 192.168.0.1
            nameservers:
                addresses:
                - 192.168.0.1
        eno3:
            dhcp4: no
            dhcp6: no
        eno4:
            dhcp4: no
            dhcp6: no
    bridges:
        br0:
            interfaces: [eno3]
            dhcp4: no
            addresses: [192.168.0.4/24]
            gateway4: 192.168.0.1
            nameservers:
                addresses: [192.168.0.1]
        br1:
            interfaces: [eno4]
            dhcp4: no
            addresses: [192.168.0.3/24]
            gateway4: 192.168.0.1
            nameservers:
                addresses: [192.168.0.1]
    version: 2
</code></pre></li><li><p>更新配置 及 查看</p><pre tabindex=0><code>#   更新
netplan apply
#   查看
networkctl status -a
</code></pre></li></ul><hr><h1 id=2-ps>2. PS:</h1><ul><li>此操作基于（root）权限操作，如用普通用户可在命令行前加“sudo”</li><li>根据网上资料亲测整理，最终解释权归<a href=http://www.wmyeah.com>WMYeah</a>所有!</li></ul><hr><h4><a href=https://www.wmyeah.com>返回首页</a></h4></div></div><footer class=container><hr class=soften><p><a href=https://gitlab.com/maxlefou/hugo.386>hugo.386 theme by Max le Fou</a> |
&copy;
<a href=http://www.wmyeah.com target=_blank>WMYeah</a>
<span id=thisyear>2023</span>
| Example site
| 构建于 <a href=//gohugo.io target=_blank>Hugo</a></p><p class=text-center></p></footer></body><link rel=stylesheet href=/css/bootstrap.css><link rel=stylesheet href=/css/bootstrap-responsive.css><link rel=stylesheet href=/css/style.css><script src=/js/jquery.js></script>
<script src=/js/bootstrap-386.js></script>
<script src=/js/bootstrap-transition.js></script>
<script src=/js/bootstrap-alert.js></script>
<script src=/js/bootstrap-modal.js></script>
<script src=/js/bootstrap-dropdown.js></script>
<script src=/js/bootstrap-scrollspy.js></script>
<script src=/js/bootstrap-tab.js></script>
<script src=/js/bootstrap-tooltip.js></script>
<script src=/js/bootstrap-popover.js></script>
<script src=/js/bootstrap-button.js></script>
<script src=/js/bootstrap-collapse.js></script>
<script src=/js/bootstrap-carousel.js></script>
<script src=/js/bootstrap-typeahead.js></script>
<script src=/js/bootstrap-affix.js></script>
<script>_386={fastLoad:!0,onePass:!0,speedFactor:.5};function ThisYear(){document.getElementById("thisyear").innerHTML=(new Date).getFullYear()}</script></html>